---
title: Git Hooks
description: äº†è§£å¦‚ä½•ä½¿ç”¨å’Œé…ç½® iGit çš„ Git Hooks
---

import { Aside } from '@astrojs/starlight/components';

## ä»€ä¹ˆæ˜¯ Git Hooks? ğŸ£

Git Hooks æ˜¯åœ¨ Git ä»“åº“ä¸­ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨æ‰§è¡Œçš„è„šæœ¬ã€‚iGit æä¾›äº†ä¸€å¥—é¢„é…ç½®çš„ Git Hooksï¼Œä»¥åŠå„ç§ç”¨æˆ·å®šä¹‰é’©å­è„šæœ¬ï¼Œå¸®åŠ©ä½ è§„èŒƒåŒ–ä»£ç æäº¤æµç¨‹ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€‚

```yaml
hooks:
  enabled: true
  hooks:
    pre-commit:
      - npm run test
      - npm run build
```

## é…ç½®è¯´æ˜ âš™ï¸

### Git Hooks é…ç½®

```yaml
hooks:
  # æ˜¯å¦å¯ç”¨ hooks
  enabled: true
  # hooks é…ç½®
  hooks:
    # å¯ä»¥é…ç½®ä»»æ„ Git hook
    pre-commit:
      - command1
      - command2
    commit-msg:
      - command1
    pre-push:
      - command1
```

### æš‚å­˜åŒº Hooks é…ç½®

æš‚å­˜åŒº hooks æ˜¯ iGit æä¾›çš„ç”¨æ¥åœ¨æäº¤å‰æ‰§è¡Œå‘½ä»¤çš„é’©å­é…ç½®ï¼Œä¸€èˆ¬å¯ä»¥åœ¨è¿™ä¸ªé˜¶æ®µå¯¹ä¿®æ”¹çš„æ–‡ä»¶æ‰§è¡Œä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–ã€‚

```yaml
staged_hooks:
  # æ˜¯å¦å¯ç”¨æš‚å­˜åŒº hooks
  enabled: true
  # é’ˆå¯¹ä¸åŒæ–‡ä»¶ç±»å‹çš„è§„åˆ™
  rules:
    "**/*.{js,ts}":
      - eslint --fix
    "**/*.{css,scss}":
      - stylelint --fix
```

### Git æäº¤ä¿¡æ¯çº¦æŸ

æˆ‘ä»¬éµå®ˆ [Conventional Commits](https://www.conventionalcommits.org/zh-hans/) è§„èŒƒï¼Œå¹¶ä½¿ç”¨ `commit-msg` é’©å­æ¥çº¦æŸæäº¤ä¿¡æ¯ã€‚ä½ å¯ä»¥é€šè¿‡ç®€å•çš„é…ç½®æ¥å¯ç”¨è¯¥åŠŸèƒ½ã€‚

```yaml
commit_msg:
  enabled: true
```

### Git æäº¤ä¿¡æ¯è¿½åŠ  Emoji

iGit æä¾›äº† `commit-msg` é’©å­æ¥çº¦æŸæäº¤ä¿¡æ¯ï¼Œå¹¶æ”¯æŒæ ¹æ®å¯¹åº”çš„ type è¿½åŠ  emojiã€‚

```yaml
commit_msg:
  enabled: true
  prependEmoji: true
```

### å‘½ä»¤æ‰§è¡Œ

- å‘½ä»¤æŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­çš„é¡ºåºä¾æ¬¡æ‰§è¡Œ
- å¦‚æœä»»ä½•å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼ˆè¿”å›éé›¶çŠ¶æ€ç ï¼‰ï¼Œhook å°†ç»ˆæ­¢æ‰§è¡Œ
- æ”¯æŒæ‰€æœ‰ shell å‘½ä»¤å’Œ `npm` è„šæœ¬

## æœ€ä½³å®è·µ ğŸ’¡

### 1. ä»£ç æ£€æŸ¥

```yaml
hooks:
  enabled: true
  hooks:
    pre-push:
      - npm run test:coverage
      - npm run build
staged_hooks:
  enabled: true
  rules:
    '**/*.{css,scss,less,styl,stylus}': stylelint --fix
    '**/*.{js,jsx,ts,tsx}': biome check --write
```

### 2. æäº¤ä¿¡æ¯è§„èŒƒ

ä½¿ç”¨ `commit-msg` ç¡®ä¿æäº¤ä¿¡æ¯ç¬¦åˆå›¢é˜Ÿè§„èŒƒï¼š

```yaml
commit_msg:
  enabled: true
  prependEmoji: true
```

## å¸¸è§é—®é¢˜ â“

### Q: å¦‚ä½•è·³è¿‡ hook æ£€æŸ¥ï¼Ÿ

åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ Git çš„ `--no-verify` é€‰é¡¹è·³è¿‡ hook æ£€æŸ¥ï¼š

```bash
git commit --no-verify -m "your message"
# æˆ–è€…
git commit -m "your message" -n
```

<Aside type="caution">
  è¯·è°¨æ…ä½¿ç”¨ `--no-verify`ï¼Œå®ƒä¼šè·³è¿‡æ‰€æœ‰çš„ hook æ£€æŸ¥ã€‚
</Aside>

### Q: hook æ‰§è¡Œå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

1. æ£€æŸ¥é”™è¯¯ä¿¡æ¯ï¼Œä¿®å¤ç›¸å…³é—®é¢˜
2. ç¡®ä¿æ‰€æœ‰å‘½ä»¤éƒ½èƒ½åœ¨å‘½ä»¤è¡Œä¸­æ­£å¸¸æ‰§è¡Œ
3. æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„å‘½ä»¤æ˜¯å¦æ­£ç¡®
